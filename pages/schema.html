

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Schema V1.0 &mdash; MFI Digital Data Backbone 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=066d2f63" />
      <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css" />

  
    <link rel="shortcut icon" href="../_static/ddb_logo.ico"/>
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=f2a433a1"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=30646c52"></script>
      <script type="module" src="https://cdn.jsdelivr.net/npm/mermaid@11.12.1/dist/mermaid.esm.min.mjs"></script>
      <script type="module" src="https://cdn.jsdelivr.net/npm/@mermaid-js/layout-elk@0.2.0/dist/mermaid-layout-elk.esm.min.mjs"></script>
      <script type="module">import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@11.12.1/dist/mermaid.esm.min.mjs";import elkLayouts from "https://cdn.jsdelivr.net/npm/@mermaid-js/layout-elk@0.2.0/dist/mermaid-layout-elk.esm.min.mjs";mermaid.registerLayoutLoaders(elkLayouts);mermaid.initialize({startOnLoad:false});</script>
      <script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script>
      <script type="module">import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@11.12.1/dist/mermaid.esm.min.mjs";

const defaultStyle = document.createElement('style');
defaultStyle.textContent = `pre.mermaid {
    /* Same as .mermaid-container > pre */
    display: block;
    width: 100%;
}

pre.mermaid > svg {
    /* Same as .mermaid-container > pre > svg */
    height: 500px;
    width: 100%;
    max-width: 100% !important;
}
`;
document.head.appendChild(defaultStyle);

const fullscreenStyle = document.createElement('style');
fullscreenStyle.textContent = `.mermaid-container {
    display: flex;
    flex-direction: row;
    width: 100%;
}

.mermaid-container > pre {
    display: block;
    width: 100%;
}

.mermaid-container > pre > svg {
    height: 500px;
    width: 100%;
    max-width: 100% !important;
}

.mermaid-fullscreen-btn {
    width: 28px;
    height: 28px;
    background: rgba(255, 255, 255, 0.95);
    border: 1px solid rgba(0, 0, 0, 0.3);
    border-radius: 4px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
    font-size: 14px;
    line-height: 1;
    padding: 0;
    color: #333;
}

.mermaid-fullscreen-btn:hover {
    opacity: 100% !important;
    background: rgba(255, 255, 255, 1);
    box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
    transform: scale(1.1);
}

.mermaid-fullscreen-btn.dark-theme {
    background: rgba(50, 50, 50, 0.95);
    border: 1px solid rgba(255, 255, 255, 0.3);
    color: #e0e0e0;
}

.mermaid-fullscreen-btn.dark-theme:hover {
    background: rgba(60, 60, 60, 1);
    box-shadow: 0 3px 10px rgba(255, 255, 255, 0.2);
}

.mermaid-fullscreen-modal {
    display: none;
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    width: 95vw;
    height: 100vh;
    background: rgba(255, 255, 255, 0.98);
    z-index: 9999;
    padding: 20px;
    overflow: auto;
}

.mermaid-fullscreen-modal.dark-theme {
    background: rgba(0, 0, 0, 0.98);
}

.mermaid-fullscreen-modal.active {
    display: flex;
    align-items: center;
    justify-content: center;
}

.mermaid-container-fullscreen {
    position: relative;
    width: 95vw;
    height: 90vh;
    max-width: 95vw;
    max-height: 90vh;
    background: white;
    border-radius: 8px;
    padding: 20px;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
    overflow: auto;
    display: flex;
    align-items: center;
    justify-content: center;
}

.mermaid-container-fullscreen.dark-theme {
    background: #1a1a1a;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.8);
}

.mermaid-container-fullscreen pre.mermaid {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
}

.mermaid-container-fullscreen .mermaid svg {
    height: 100% !important;
    width: 100% !important;
    cursor: grab;
}

.mermaid-fullscreen-close {
    position: fixed !important;
    top: 20px !important;
    right: 20px !important;
    width: 40px;
    height: 40px;
    background: rgba(255, 255, 255, 0.95);
    border: 1px solid rgba(0, 0, 0, 0.2);
    border-radius: 50%;
    cursor: pointer;
    z-index: 10000;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    transition: all 0.2s;
    font-size: 24px;
    line-height: 1;
    color: #333;
}

.mermaid-fullscreen-close:hover {
    background: white;
    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.4);
    transform: scale(1.1);
}

.mermaid-fullscreen-close.dark-theme {
    background: rgba(50, 50, 50, 0.95);
    border: 1px solid rgba(255, 255, 255, 0.2);
    color: #e0e0e0;
}

.mermaid-fullscreen-close.dark-theme:hover {
    background: rgba(60, 60, 60, 1);
    box-shadow: 0 6px 16px rgba(255, 255, 255, 0.2);
}

.mermaid-fullscreen-modal .mermaid-fullscreen-btn {
    display: none !important;
}`;
document.head.appendChild(fullscreenStyle);

// Detect if page has dark background
const isDarkTheme = () => {
    const bgColor = window.getComputedStyle(document.body).backgroundColor;
    const match = bgColor.match(/rgb\((\d+),\s*(\d+),\s*(\d+)/);
    if (match) {
        const r = parseInt(match[1]);
        const g = parseInt(match[2]);
        const b = parseInt(match[3]);
        const brightness = (r * 299 + g * 587 + b * 114) / 1000;
        return brightness < 128;
    }
    return false;
};

const load = async () => {
    await mermaid.run();

    const all_mermaids = document.querySelectorAll(".mermaid");
    const mermaids_processed = document.querySelectorAll(".mermaid[data-processed='true']");

    if ("False" === "True") {
        const mermaids_to_add_zoom = -1 === -1 ? all_mermaids.length : -1;
        if(mermaids_to_add_zoom > 0) {
            var svgs = d3.selectAll("");
            if(all_mermaids.length !== mermaids_processed.length) {
                setTimeout(load, 200);
                return;
            } else if(svgs.size() !== mermaids_to_add_zoom) {
                setTimeout(load, 200);
                return;
            } else {
                svgs.each(function() {
                    var svg = d3.select(this);
                    svg.html("<g class='wrapper'>" + svg.html() + "</g>");
                    var inner = svg.select("g");
                    var zoom = d3.zoom().on("zoom", function(event) {
                        inner.attr("transform", event.transform);
                    });
                    svg.call(zoom);
                });
            }
        }
    } else if(all_mermaids.length !== mermaids_processed.length) {
        // Wait for mermaid to process all diagrams
        setTimeout(load, 200);
        return;
    }

    const darkTheme = isDarkTheme();

    // Stop here if not adding fullscreen capability
    if ("True" !== "True") return;

    const modal = document.createElement('div');
    modal.className = 'mermaid-fullscreen-modal' + (darkTheme ? ' dark-theme' : '');
    modal.setAttribute('role', 'dialog');
    modal.setAttribute('aria-modal', 'true');
    modal.setAttribute('aria-label', 'Fullscreen diagram viewer');
    modal.innerHTML = `
        <button class="mermaid-fullscreen-close${darkTheme ? ' dark-theme' : ''}" aria-label="Close fullscreen">✕</button>
        <div class="mermaid-container-fullscreen${darkTheme ? ' dark-theme' : ''}"></div>
    `;
    document.body.appendChild(modal);

    const modalContent = modal.querySelector('.mermaid-container-fullscreen');
    const closeBtn = modal.querySelector('.mermaid-fullscreen-close');

    let previousScrollOffset = [window.scrollX, window.scrollY];

    const closeModal = () => {
        modal.classList.remove('active');
        modalContent.innerHTML = '';
        document.body.style.overflow = ''
        window.scrollTo({left: previousScrollOffset[0], top: previousScrollOffset[1], behavior: 'instant'});
    };

    closeBtn.addEventListener('click', closeModal);
    modal.addEventListener('click', (e) => {
        if (e.target === modal) closeModal();
    });
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && modal.classList.contains('active')) {
            closeModal();
        }
    });

    const allButtons = [];

    document.querySelectorAll('.mermaid').forEach((mermaidDiv) => {
        if (mermaidDiv.parentNode.classList.contains('mermaid-container') ||
            mermaidDiv.closest('.mermaid-fullscreen-modal')) {
            return;
        }

        const container = document.createElement('div');
        container.className = 'mermaid-container';
        mermaidDiv.parentNode.insertBefore(container, mermaidDiv);
        container.appendChild(mermaidDiv);

        const fullscreenBtn = document.createElement('button');
        fullscreenBtn.className = 'mermaid-fullscreen-btn' + (darkTheme ? ' dark-theme' : '');
        fullscreenBtn.setAttribute('aria-label', 'View diagram in fullscreen');
        fullscreenBtn.textContent = '⛶';
        fullscreenBtn.style.opacity = '50%';

        // Calculate dynamic position based on diagram's margin and padding
        const diagramStyle = window.getComputedStyle(mermaidDiv);
        const marginTop = parseFloat(diagramStyle.marginTop) || 0;
        const marginRight = parseFloat(diagramStyle.marginRight) || 0;
        const paddingTop = parseFloat(diagramStyle.paddingTop) || 0;
        const paddingRight = parseFloat(diagramStyle.paddingRight) || 0;
        fullscreenBtn.style.top = `${marginTop + paddingTop + 4}px`;
        fullscreenBtn.style.right = `${marginRight + paddingRight + 4}px`;

        fullscreenBtn.addEventListener('click', () => {
            previousScrollOffset = [window.scroll, window.scrollY];
            const clone = mermaidDiv.cloneNode(true);
            modalContent.innerHTML = '';
            modalContent.appendChild(clone);

            const svg = clone.querySelector('svg');
            if (svg) {
                svg.removeAttribute('width');
                svg.removeAttribute('height');
                svg.style.width = '100%';
                svg.style.height = 'auto';
                svg.style.maxWidth = '100%';
                svg.style.sdisplay = 'block';

                if ("False" === "True") {
                    setTimeout(() => {
                        const g = svg.querySelector('g');
                        if (g) {
                            var svgD3 = d3.select(svg);
                            svgD3.html("<g class='wrapper'>" + svgD3.html() + "</g>");
                            var inner = svgD3.select("g");
                            var zoom = d3.zoom().on("zoom", function(event) {
                                inner.attr("transform", event.transform);
                            });
                            svgD3.call(zoom);
                        }
                    }, 100);
                }
            }

            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
        });

        container.appendChild(fullscreenBtn);
        allButtons.push(fullscreenBtn);
    });

    // Update theme classes when theme changes
    const updateTheme = () => {
        const dark = isDarkTheme();
        allButtons.forEach(btn => {
            if (dark) {
                btn.classList.add('dark-theme');
            } else {
                btn.classList.remove('dark-theme');
            }
        });
        if (dark) {
            modal.classList.add('dark-theme');
            modalContent.classList.add('dark-theme');
            closeBtn.classList.add('dark-theme');
        } else {
            modal.classList.remove('dark-theme');
            modalContent.classList.remove('dark-theme');
            closeBtn.classList.remove('dark-theme');
        }
    };

    // Watch for theme changes
    const observer = new MutationObserver(updateTheme);
    observer.observe(document.documentElement, {
        attributes: true,
        attributeFilter: ['class', 'style', 'data-theme']
    });
    observer.observe(document.body, {
        attributes: true,
        attributeFilter: ['class', 'style']
    });
};

window.addEventListener("load", load);
</script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Software" href="software.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            MFI Digital Data Backbone
              <img src="../_static/ddb_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="architecture.html">Architecture</a><ul>
<li class="toctree-l2"><a class="reference internal" href="architecture/data_generators.html">Data Generators</a></li>
<li class="toctree-l2"><a class="reference internal" href="architecture/data_adapters.html">Data Adapters</a><ul>
<li class="toctree-l3"><a class="reference internal" href="architecture/data_adapters.html#data-adapter-schema">Data Adapter Schema</a></li>
<li class="toctree-l3"><a class="reference internal" href="architecture/data_adapters.html#topic-structure">Topic Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="architecture/data_adapters.html#payload-schema">Payload Schema</a><ul>
<li class="toctree-l4"><a class="reference internal" href="architecture/data_adapters.html#historian-time-series">historian [time-series]</a></li>
<li class="toctree-l4"><a class="reference internal" href="architecture/data_adapters.html#blob-binary-data">blob [binary data]</a></li>
<li class="toctree-l4"><a class="reference internal" href="architecture/data_adapters.html#kv-non-time-series">kv [non-time-series]</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="architecture/data_adapters.html#streaming-metadata">Streaming Metadata</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="architecture/publishsubscribe.html">Publish-Subscribe Broker</a></li>
<li class="toctree-l2"><a class="reference internal" href="architecture/cloudstorage.html">Cloud Storage</a></li>
<li class="toctree-l2"><a class="reference internal" href="architecture/retrieval.html">Retrieval</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="software.html">Software</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Schema V1.0</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#topic-structure">Topic Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="#payload-schema">Payload Schema</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#historian-time-series">historian [time-series]</a></li>
<li class="toctree-l3"><a class="reference internal" href="#blob-binary-data">blob [binary data]</a></li>
<li class="toctree-l3"><a class="reference internal" href="#kv-non-time-series">kv [non-time-series]</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#streaming-metadata">Streaming Metadata</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MFI Digital Data Backbone</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Schema V1.0</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/cmu-mfi/ddb/blob/main/doc/pages/schema.md" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="schema-v1-0">
<h1>Schema V1.0<a class="headerlink" href="#schema-v1-0" title="Link to this heading"></a></h1>
<p>MFI DDB Schema V1.0 is a schema for the data that is streamed to the Digital Data Backbone (DDB) for the MFI project. The schema is designed to be flexible and extensible to accommodate different types of data.\</p>
<p>The messages are published to an MQTT broker, which uses the publish-subscribe model to route them to the appropriate subscribers. The schema defines the topics used for different types of data and specifies the structure of the payload for each data type.</p>
<section id="topic-structure">
<h2>Topic Structure<a class="headerlink" href="#topic-structure" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><strong>historian</strong> [time series data]: Sparkplug B</p></li>
<li><p><strong>kv</strong> [non-time series data]: Key-Value</p></li>
<li><p><strong>blob</strong> [files]: Binary Large Object</p></li>
</ul>
<pre  class="mermaid">
        flowchart LR;
    B[mfi-v1.0];
    B --&gt; C[historian] --&gt; F[&quot;enterprise&quot;];
    B --&gt; D[kv] --&gt; F;
    B --&gt; E[blob] --&gt; F;
    F --&gt; G[&quot;site*&quot;];
    G --&gt; H[&quot;area*&quot;];
    H --&gt; I[&quot;device*&quot;];
    I --&gt; X[&quot;...&quot;];
    F --&gt; X;
    G --&gt; X;
    H --&gt; X;


    classDef highlight fill:#84c964
    class A,B,C,D,E highlight
    </pre><blockquote>
<div><p>*  <code class="docutils literal notranslate"><span class="pre">site</span></code>, <code class="docutils literal notranslate"><span class="pre">area</span></code>, and <code class="docutils literal notranslate"><span class="pre">device</span></code> are optional placeholders for the actual values of the enterprise, site, area, and device.</p>
</div></blockquote>
<p>Examples:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">mfi-v1.0-kv/CMU/Mill19/Mezzanine-Lab/yk-destroyer/#</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mfi-v1.0-historian/CMU/Mill19/HAAS-UMC750/#</span></code></p></li>
</ul>
</section>
<section id="payload-schema">
<h2>Payload Schema<a class="headerlink" href="#payload-schema" title="Link to this heading"></a></h2>
<section id="historian-time-series">
<h3>historian [time-series]<a class="headerlink" href="#historian-time-series" title="Link to this heading"></a></h3>
<p>Since we are using Aveva PI to store our time series data, we have adopted the Sparkplug B schema as an initial model for inspiration. It’s flexibility allows it to be applied to other data types. The general schema for Sparkplug B v1.0 is defined in the <a class="reference external" href="https://sparkplug.eclipse.org/specification/version/3.0/documents/sparkplug-specification-3.0.0.pdf">Sparkplug specification</a>.</p>
<p>Key points to note:</p>
<ul class="simple">
<li><p>Sparkplug requires following topic structure: <code class="docutils literal notranslate"><span class="pre">namespace/group_id/message_type/node_id/[device_id]</span></code></p></li>
<li><p>Sparkplug messages are serialized using Google Protocol Buffers (<a class="reference external" href="https://protobuf.dev/">protobuf</a>).</p></li>
<li><p>In reference to the above structure,</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">namespace</span></code> = <code class="docutils literal notranslate"><span class="pre">mfi-v1.0-historian</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">group_id</span></code> = <code class="docutils literal notranslate"><span class="pre">enterprise</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">message_type</span></code> = Sparkplug B message type, like DDATA, DBIRTH, etc.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">node_id</span></code> = <code class="docutils literal notranslate"><span class="pre">site</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">device_id</span></code> = <code class="docutils literal notranslate"><span class="pre">area</span></code> (optional)</p></li>
</ul>
</li>
<li><p>mfi_ddb expects at least a DBIRTH message to establish identity and a DDATA message to send data.</p></li>
<li><p>Metric naming convention is defined in <a class="reference internal" href="#./historian-metric-naming.md"><span class="xref myst">historian-metric-naming.md</span></a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mfi_ddb</span></code> library uses <a class="reference external" href="https://pypi.org/project/mqtt-spb-wrapper/">mqtt-spb-wrapper</a> to create sparkplug messages.</p></li>
<li><p>The messages while not directly human-readable, can be decoded using the <a class="reference external" href="https://github.com/cmu-mfi/mfi_ddb_library/blob/main/schema/spbv.proto">protobuf schema</a>. Some MQTT brokers, <a class="reference external" href="https://www.emqx.com/en/blog/mqtt-sparkplug-in-action-a-step-by-step-tutorial">like EMQX</a>, have built in capability to do so.</p></li>
</ul>
</section>
<section id="blob-binary-data">
<h3>blob [binary data]<a class="headerlink" href="#blob-binary-data" title="Link to this heading"></a></h3>
<p>blob topic tree expects large binary files.</p>
<ul class="simple">
<li><p>The file data is sent as a binary payload of a json message.</p></li>
<li><p>The json message is serialized using <a class="reference external" href="https://protobuf.dev/">protobuf</a> protocol.</p></li>
<li><p>The schema is defined in <a class="reference external" href="https://github.com/cmu-mfi/mfi_ddb_library/blob/main/schema/blob.proto">blob.proto</a>.</p></li>
<li><p>The messages while not directly human-readable, can be decoded using the above protobuf schema. Some MQTT brokers, <a class="reference external" href="https://www.emqx.com/en/blog/mqtt-sparkplug-in-action-a-step-by-step-tutorial">like EMQX</a>, have built in capability to do so.</p></li>
</ul>
</section>
<section id="kv-non-time-series">
<h3>kv [non-time-series]<a class="headerlink" href="#kv-non-time-series" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>The messages in k-v topic tree can be used to send non-time series data.</p></li>
<li><p>The schema is designed to be flexible and extensible to accommodate different types of data.</p></li>
<li><p>The schema is defined in <a class="reference external" href="https://github.com/cmu-mfi/mfi_ddb_library/blob/main/schema/kv.json">kv.json</a>.</p></li>
<li><p>While <a class="reference internal" href="#blob-binary-data"><span class="xref myst">blob</span></a> and <a class="reference internal" href="#historian-time-series"><span class="xref myst">historian</span></a> are protobuf serialized, k-v messages are sent as json for ease of readability.</p></li>
</ul>
</section>
</section>
<section id="streaming-metadata">
<h2>Streaming Metadata<a class="headerlink" href="#streaming-metadata" title="Link to this heading"></a></h2>
<p>When streaming data to the broker, the following metadata is recorded through the <code class="docutils literal notranslate"><span class="pre">mfi-ddb</span></code> stream:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Metadata</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Recorded as</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>location context</p></td>
<td><p>The location context of the data being streamed, which includes the enterprise, site, area, and device.</p></td>
<td><p><a class="reference internal" href="#topic-structure"><span class="xref myst">topic structure</span></a></p></td>
</tr>
<tr class="row-odd"><td><p>attributes</p></td>
<td><p>Key-value pairs that provide additional information about the data being streamed. These are defined in the adapter yaml configuration file.</p></td>
<td><p>streamed on the same topic before data using the same topic family encoding</p></td>
</tr>
<tr class="row-even"><td><p>streaming configuration</p></td>
<td><p>The configuration of the data stream, which includes broker information, enterprise and site details.</p></td>
<td><p>streamed on the <code class="docutils literal notranslate"><span class="pre">kv</span></code> and <code class="docutils literal notranslate"><span class="pre">blob</span></code> at birth and death of data streaming</p></td>
</tr>
<tr class="row-odd"><td><p>adapter configuration</p></td>
<td><p>The configuration of the adapter that is streaming the data, which includes all the components and their attributes</p></td>
<td><p>streamed on the <code class="docutils literal notranslate"><span class="pre">kv</span></code> and <code class="docutils literal notranslate"><span class="pre">blob</span></code> at birth and death of data streaming</p></td>
</tr>
</tbody>
</table>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="software.html" class="btn btn-neutral float-left" title="Software" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Carnegie Mellon University, Manufacturing Futures Institute.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>
</html>